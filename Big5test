<div id="personality-test-widget" style="width:100%;max-width:600px;margin:0 auto;">
    <style>
        /* Ajout de la classe hidden */
        .hidden {
            display: none;
        }

        /* Vos autres styles CSS ici */
        .card {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            font-family: Arial, sans-serif;
        }
        .title {
            text-align: center;
            margin-bottom: 20px;
        }
        .start-btn, .reset-btn {
            display: block;
            margin: 0 auto;
            padding: 10px 20px;
            background: #3b82f6;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .start-btn:hover, .reset-btn:hover {
            background: #2563eb;
        }
        .progress {
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            height: 10px;
            margin-bottom: 20px;
        }
        .progress-bar {
            background: #3b82f6;
            height: 100%;
            transition: width 0.3s;
        }
        .question {
            font-size: 18px;
            margin-bottom: 20px;
            text-align: center;
        }
        .button {
            display: block;
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            cursor: pointer;
            text-align: center;
        }
        .button:hover {
            background: #e5e7eb;
        }
        .result-bar {
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            height: 20px;
        }
        .result-fill {
            height: 100%;
        }
    </style>
    <div class="card">
        <div id="start-section">
            <h1 class="title">Test de Personnalité</h1>
            <p style="text-align: center; margin-bottom: 20px;">Découvrez votre profil de personnalité en répondant à quelques questions simples.</p>
            <button class="start-btn" id="start-quiz">Commencer le test</button>
        </div>
        <div id="quiz-section" class="hidden">
            <h1 class="title">Test de Personnalité</h1>
            <div class="progress">
                <div id="progress-bar" class="progress-bar" style="width: 0%"></div>
            </div>
            <div id="question" class="question"></div>
            <div id="answers"></div>
        </div>
        <div id="results-section" class="hidden"></div>
    </div>
    <script>
    (function() {
        const widget = document.getElementById('personality-test-widget');
        const questions = [
            { text: "J'aime explorer de nouvelles idées", trait: "openness" },
            { text: "Je suis organisé(e) et méthodique", trait: "conscientiousness" },
            { text: "J'aime être entouré(e) de gens", trait: "extraversion" },
            { text: "Je suis attentif(ve) aux autres", trait: "agreeableness" },
            { text: "Je reste calme sous pression", trait: "neuroticism" },
            { text: "Je suis créatif(ve)", trait: "openness" },
            { text: "Je planifie tout à l'avance", trait: "conscientiousness" },
            { text: "Je communique facilement", trait: "extraversion" },
            { text: "J'aide volontiers les autres", trait: "agreeableness" },
            { text: "Je gère bien mes émotions", trait: "neuroticism" }
        ];

        const traits = {
            openness: { name: 'Ouverture', color: '#3b82f6' },
            conscientiousness: { name: 'Conscience', color: '#10b981' },
            extraversion: { name: 'Extraversion', color: '#f59e0b' },
            agreeableness: { name: 'Agréabilité', color: '#ec4899' },
            neuroticism: { name: 'Stabilité émotionnelle', color: '#8b5cf6' }
        };

        let currentQuestion = 0;
        let answers = [];

        function startQuiz() {
            widget.querySelector('#start-section').classList.add('hidden');
            widget.querySelector('#quiz-section').classList.remove('hidden');
            showQuestion();
        }

        function showQuestion() {
            const question = questions[currentQuestion];
            widget.querySelector('#question').textContent = question.text;
            widget.querySelector('#progress-bar').style.width = `${(currentQuestion + 1) * 10}%`;

            const answersHtml = [
                { value: 1, text: 'Pas du tout d\'accord' },
                { value: 2, text: 'Plutôt pas d\'accord' },
                { value: 3, text: 'Neutre' },
                { value: 4, text: 'Plutôt d\'accord' },
                { value: 5, text: 'Tout à fait d\'accord' }
            ].map(answer => `
                <button class="button" data-value="${answer.value}">
                    ${answer.text}
                </button>
            `).join('');

            widget.querySelector('#answers').innerHTML = answersHtml;
        }

        function answer(value) {
            answers.push(parseInt(value));
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            const results = {};
            Object.keys(traits).forEach(trait => {
                const scores = questions.map((q, i) => q.trait === trait ? answers[i] : null)
                    .filter(score => score !== null);
                results[trait] = (scores.reduce((a, b) => a + b, 0) / scores.length / 5) * 100;
            });

            const resultsHtml = Object.entries(traits).map(([trait, info]) => `
                <div style="margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <strong>${info.name}</strong>
                        <span>${Math.round(results[trait])}%</span>
                    </div>
                    <div class="result-bar">
                        <div class="result-fill" 
                             style="width: ${results[trait]}%; background: ${info.color}">
                        </div>
                    </div>
                </div>
            `).join('');

            widget.querySelector('#quiz-section').classList.add('hidden');
            widget.querySelector('#results-section').classList.remove('hidden');
            widget.querySelector('#results-section').innerHTML = `
                <h2 class="title">Vos Résultats</h2>
                ${resultsHtml}
                <button class="reset-btn" id="reset-quiz">Recommencer le test</button>
            `;
        }

        function resetQuiz() {
            currentQuestion = 0;
            answers = [];
            widget.querySelector('#results-section').classList.add('hidden');
            widget.querySelector('#start-section').classList.remove('hidden');
            widget.querySelector('#quiz-section').classList.add('hidden');
        }

        // Ajout des écouteurs d'événements
        widget.addEventListener('click', function(event) {
            if (event.target.id === 'start-quiz') {
                startQuiz();
            } else if (event.target.classList.contains('button') && event.target.dataset.value) {
                answer(event.target.dataset.value);
            } else if (event.target.id === 'reset-quiz') {
                resetQuiz();
            }
        });

    })();
    </script>
</div>
